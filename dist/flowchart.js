!function(e){var t={};function n(o){if(t[o])return t[o].exports;var i=t[o]={i:o,l:!1,exports:{}};return e[o].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(o,i,function(t){return e[t]}.bind(null,i));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=1)}([function(e,t,n){},function(e,t,n){"use strict";function o(){this.items=[]}n.r(t),o.prototype.getForId=function(e){for(var t=0;t<this.items.length;t++)if(this.items[t].id===e)return this.items[t];return null},o.prototype.addTestData=function(){this.items.push({id:"a",title:"Hello world A",description:"Question",x:450,y:200,connections:[{id:"b",label:"yes"},{id:"c",label:"no"}]}),this.items.push({id:"b",title:"Hello world B",description:"Question",x:200,y:500,connections:[{id:"d",label:"yes"},{id:"c",label:"no"}]}),this.items.push({id:"c",title:"Hello world C",description:"Question",x:700,y:500,connections:[{id:"d",label:"yes"}]}),this.items.push({id:"d",title:"Hello world D",description:"Question",x:450,y:800,connections:[]})};var i=o;function s(e,t){this.parentContainer=e,this.nodes=t,this.canvas=null,this.context=null}s.prototype.init=function(){this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),this.parentContainer.appendChild(this.canvas)},s.prototype.render=function(){const e=this.context;this.canvas.width=this.parentContainer.clientWidth,this.canvas.height=this.parentContainer.offsetHeight,e.clearRect(0,0,this.canvas.width,this.canvas.height),e.lineWidth=2,e.strokeStyle="#e4e4e4";const t=this.nodes.items;for(var n=0;n<t.length;n++){const i=this.getNodeElementCenter(t[n]);for(var o=0;o<t[n].connections.length;o++){const s=this.nodes.getForId(t[n].connections[o].id),r=this.getNodeElementCenter(s);e.beginPath(),e.moveTo(i.x,i.y),e.lineTo(r.x,r.y),e.stroke()}}},s.prototype.getNodeElementCenter=function(e){return{x:e.x+130,y:e.y+37}};var r=s;function l(e,t){this.target=e.target,this.initialPageX=e.pageX,this.initialPageY=e.pageY,this.first=!0,this.transform=t.transform}l.prototype.setInitialPosition=function(e,t){this.initialX=e,this.initialY=t},l.prototype.setInitialSize=function(e,t){this.initialWidth=e,this.initialHeight=t},l.prototype.setTransformMode=function(e,t){this.hmode=e,this.vmode=t},l.prototype.setController=function(e){this.controller=e},l.prototype.setInnerTarget=function(e){this.innerTarget=e};var a=l;var d=function(){const e=this;e.session=null,e.start=function(t,n){const o=new a(t,n);return n.init(o),e.session=o,window.addEventListener("mousemove",e.moveHandler,!0),window.addEventListener("mouseup",e.moveUpHandler,!1),t.stopPropagation&&t.stopPropagation(),t.preventDefault&&t.preventDefault(),t.cancelBubble=!0,t.returnValue=!1,!1},e.hasSession=function(){return null!==e.session},e.moveHandler=function(t){const n=t.pageX-e.session.initialPageX,o=t.pageY-e.session.initialPageY;return e.session.transform(e.session,n,o,t.pageX,t.pageY,e.session.first,!1),e.session.first=!1,t.stopPropagation&&t.stopPropagation(),t.preventDefault&&t.preventDefault(),t.cancelBubble=!0,t.returnValue=!1,!1},e.moveUpHandler=function(t){window.removeEventListener("mousemove",e.moveHandler,!0),window.removeEventListener("mouseup",e.moveUpHandler,!1);const n=t.pageX-e.session.initialPageX,o=t.pageY-e.session.initialPageY;e.session.transform(e.session,n,o,t.pageX,t.pageY,e.session.first,!0),e.session=null}};function c(e,t){this.parent=e,this.node=t,this.element=null,this.selected=!1}c.prototype.render=function(){const e=document.createElement("div");e.classList.add("node");const t=document.createElement("div");t.classList.add("inner"),e.appendChild(t),t.appendChild(this.renderActions()),t.appendChild(this.renderInfo()),e.style.top=this.node.y+"px",e.style.left=this.node.x+"px";const n=this;return e.addEventListener("mousedown",t=>{n.startDragDrop(t,e)}),this.element=e,e},c.prototype.renderInfo=function(){const e=document.createElement("div"),t=document.createElement("div"),n=document.createElement("div");e.classList.add("info"),t.classList.add("title"),n.classList.add("description"),e.appendChild(t),e.appendChild(n),t.innerText=this.node.title,n.innerText=this.node.description;const o=this;return e.addEventListener("click",(function(){o.onNodeSelected()})),e},c.prototype.renderActions=function(){const e=document.createElement("div"),t=document.createElement("div"),n=document.createElement("div");e.classList.add("actions"),t.innerText="Edit",n.innerText="Link",e.appendChild(t),e.appendChild(n);const o=this;return t.addEventListener("click",(function(){o.onEditNode()})),n.addEventListener("click",(function(){o.onLinkNode()})),e},c.prototype.applyPosition=function(){this.element.style.top=this.node.y+"px",this.element.style.left=this.node.x+"px",this.parent.onNodePositionChanged()},c.prototype.applySelected=function(){this.element.classList.contains("selected")!=this.selected&&(this.selected?this.element.classList.add("selected"):this.element.classList.remove("selected"))},c.prototype.startDragDrop=function(e){const t=this;this.parent.dragDropEngine.start(e,{init(e){e.setInitialPosition(t.node.x,t.node.y),t.onNodeSelected()},transform(e,n,o,i,s,r,l){r&&t.element.classList.contains("animate-position")&&t.element.classList.remove("animate-position"),t.node.x=e.initialX+n,t.node.y=e.initialY+o,t.applyPosition()}})},c.prototype.getNodeId=function(){return this.node.id},c.prototype.onEditNode=function(){this.parent.onEditNode(this)},c.prototype.onLinkNode=function(){this.parent.onLinkNode(this)},c.prototype.onNodeSelected=function(){this.selected||(this.selected=!0,this.applySelected(),this.selected&&this.parent.onNodeSelected(this))};var p=c;function h(e,t,n,o){this.parent=e,this.from=t,this.to=n,this.label=o,this.element=null,this.selected=!1,this.actions=[{title:"Rename"},{title:"Remove"}]}h.prototype.render=function(){const e=document.createElement("div");e.classList.add("label");const t=document.createElement("div");t.classList.add("inner"),t.innerText=this.label,t.appendChild(this.renderActions()),e.appendChild(t);const n=this.getLineCenter();e.style.top=n.y+"px",e.style.left=n.x+"px";const o=this;return e.addEventListener("click",(function(){o.onLabelSelected()})),this.element=e,e},h.prototype.renderActions=function(){const e=document.createElement("div"),t=document.createElement("div"),n=document.createElement("div");e.classList.add("actions"),t.innerText="Rename",n.innerText="Remove",e.appendChild(t),e.appendChild(n);const o=this;return t.addEventListener("click",(function(){o.onRenameLabel()})),n.addEventListener("click",(function(){o.onRemoveConnection()})),e},h.prototype.updatePosition=function(){var e=this.getLineCenter();this.element.style.top=e.y+"px",this.element.style.left=e.x+"px"},h.prototype.getLineCenter=function(){return{x:(this.from.x+this.to.x)/2+130-50,y:(this.from.y+this.to.y)/2+37-17}},h.prototype.applySelected=function(){this.element.classList.contains("selected")!=this.selected&&(this.selected?this.element.classList.add("selected"):this.element.classList.remove("selected"))},h.prototype.onRenameLabel=function(){this.parent.onRenameLabel(this.from,this.to)},h.prototype.onRemoveConnection=function(){this.parent.onRemoveConnection(this.from,this.to)},h.prototype.onLabelSelected=function(){this.selected||(this.selected=!0,this.applySelected(),this.parent.onLabelSelected(this))};var u=h;function f(e,t){this.parent=e,this.parentContainer=e.container,this.nodes=t,this.nodeControllers=null,this.labelControllers=null,this.container=null,this.dragDropEngine=new d}f.prototype.init=function(){this.container=document.createElement("div"),this.container.classList.add("node-container"),this.parentContainer.appendChild(this.container)},f.prototype.createNodeControllers=function(){this.nodeControllers=[];const e=this.nodes.items;for(var t=0;t<e.length;t++)this.nodeControllers.push(new p(this,e[t]))},f.prototype.createLabelControllers=function(){this.labelControllers=[];const e=this.nodes.items;for(var t=0;t<e.length;t++)for(var n=0;n<e[t].connections.length;n++){var o=e[t],i=this.nodes.getForId(e[t].connections[n].id),s=e[t].connections[n].label;this.labelControllers.push(new u(this,o,i,s))}},f.prototype.render=function(){this.container.innerHTML="",this.createNodeControllers(),this.createLabelControllers();for(var e=0;e<this.nodeControllers.length;e++){var t=this.nodeControllers[e].render();this.container.appendChild(t)}for(e=0;e<this.labelControllers.length;e++){var n=this.labelControllers[e].render();this.container.appendChild(n)}},f.prototype.updateLabelPositions=function(){for(var e=0;e<this.labelControllers.length;e++)this.labelControllers[e].updatePosition()},f.prototype.onNodePositionChanged=function(){this.updateLabelPositions(),this.parent.onNodePositionChanged()},f.prototype.onLabelSelected=function(e){for(var t=0;t<this.nodeControllers.length;t++){const e=this.nodeControllers[t];e.selected=!1,e.applySelected()}for(var n=0;n<this.labelControllers.length;n++){const t=this.labelControllers[n];t!==e&&(t.selected=!1,t.applySelected())}},f.prototype.onNodeSelected=function(e){for(var t=0;t<this.nodeControllers.length;t++){const n=this.nodeControllers[t];n!==e&&(n.selected=!1,n.applySelected())}for(var n=0;n<this.labelControllers.length;n++){const e=this.labelControllers[n];e.selected=!1,e.applySelected()}},f.prototype.onEditNode=function(e){this.parent.onEditNode(e.getNodeId())},f.prototype.onLinkNode=function(e){this.parent.onLinkNode(e.getNodeId())},f.prototype.onRenameLabel=function(e,t){this.parent.onRenameLabel(e,t)},f.prototype.onRemoveConnection=function(e,t){this.parent.onRemoveConnection(e,t)};var m=f;function v(e){this.parentContainer=document.querySelector(e),this.container=document.createElement("div"),this.container.classList.add("flowchart"),this.parentContainer.appendChild(this.container),this.nodes=new i,this.canvas=new r(this.container,this.nodes),this.dom=new m(this,this.nodes),this.renameLabelHandler=function(e,t){var n=prompt("Enter a new name",e);null!==n&&t(n)}}v.prototype.init=function(){this.canvas.init(),this.dom.init(),this.nodes.addTestData(),this.render()},v.prototype.render=function(){this.canvas.render(),this.dom.render()},v.prototype.onNodePositionChanged=function(){this.canvas.render()},v.prototype.onRenameLabel=function(e,t){for(var n=null,o=0;o<e.connections.length;o++)e.connections[o].id===t.id&&(n=e.connections[o]);if(null===n)throw"Connection not found";const i=this;this.renameLabelHandler(n.label,(function(e){e.length>0&&n.label!==e&&(n.label=e,i.render())}))},v.prototype.onRemoveConnection=function(e,t){for(var n=0;n<e.connections.length;n++)if(e.connections[n].id===t.id){e.connections.splice(n,1);break}this.render()},v.prototype.onEditNode=function(e){alert("edit node: "+e)},v.prototype.onLinkNode=function(e){alert("link node: "+e)};var y=v;n(0);window.Flowchart=y}]);